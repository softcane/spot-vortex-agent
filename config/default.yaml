# SpotVortex Configuration
# Note: Model support scope is enforced by models/MODEL_MANIFEST.json, not aws/gcp catalog lists.

controller:
  # Risk threshold for triggering drain (0.0 - 1.0)
  # Nodes with interruption probability above this are drained
  riskThreshold: 0.85

  # Maximum percentage of cluster to drain simultaneously (0.0 - 1.0)
  # Thundering herd protection per mission_guardrail.md
  maxDrainRatio: 0.10

  # Seconds between reconciliation cycles
  reconcileIntervalSeconds: 30

  # Minimum model confidence required to take action (0.0 - 1.0)
  # If below this, fall back to On-Demand (Prime Directive)
  confidenceThreshold: 0.50

  # Grace period for pod eviction in seconds
  drainGracePeriodSeconds: 60

inference:
  # Paths to ONNX model files (required for live operation)
  tftModelPath: "models/tft.onnx"
  rlModelPath: "models/rl_policy.onnx"
  modelManifestPath: "models/MODEL_MANIFEST.json"
  # Must match manifest cloud (if set).
  expectedCloud: "aws"

prometheus:
  # Prometheus server URL (required)
  url: "http://prometheus:9090"

  # Scrape timeout in seconds
  timeoutSeconds: 10

# Autoscaling (ASG) integration for Cluster Autoscaler and EKS Managed Nodegroups.
# Per integration_strategy.md Section 4: Twin ASG model for Spot <-> OD swaps.
autoscaling:
  enabled: false
  discoveryTags:
    pool: "spotvortex.io/pool"
    type: "spotvortex.io/capacity-type"  # Values: spot, on-demand
  nodeReadyTimeoutSeconds: 300  # 5 minutes
  pollIntervalSeconds: 10

aws:
  # AWS region used by price provider fallback path.
  region: "us-east-1"

  # Optional catalog hints for pricing workflows (not model-scope enforcement).
  instanceTypes: []
  availabilityZones: []

gcp:
  # GCP project ID (required for GCP support)
  projectId: ""

  # GCP region for preemptible pricing
  region: "us-central1"

  # Optional catalog hints for pricing workflows (not model-scope enforcement).
  machineTypes: []
